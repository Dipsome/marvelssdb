{% macro integer_or_x(value, special_text) %}
{% if value is null %}{% if special_text is null%}&ndash;{% endif %}{% elseif value < 0 %}X{% else %}{{ value }}{% endif %}{% if special_text %}<span class="icon icon-special"></span>{% endif %}
{% endmacro %}

{% macro card_name_with_pack_no_link(card) %}
<a class="card-tip" data-code="{{ card.code }}">{{ card.name }} <i>({{ card.pack.name }})</i></a>
{% endmacro %}

{% macro card_name_no_link(card) %}<a style="color : inherit;" class="card-tip card-preview" data-code="{{ card.code }}">{{ card.name }}</a>{% endmacro %}

{% macro decklist_table_row(decklist) %}
<tr>
	<td class="decklist-name"><a href="{{ path('decklist_detail', { 'decklist_id': decklist.id, 'decklist_name': decklist.nameCanonical|e('url') }) }}">{{ decklist.name }}</a></td>
	<td><span class="fa fa-heart social-icon-like"></span> {{ decklist.nbVotes }}</td>
	<td><span class="fa fa-star social-icon-favorite"></span> {{ decklist.nbFavorites }}</td>
	<td><span class="fa fa-comment social-icon-comment"></span> {{ decklist.nbComments }}</td>
	<td><span class="fa fa-code-fork social-icon-version"></span> {{ decklist.version }}</td>
</tr>
{% endmacro %}

{% macro username(user) %}
<a href="{{ path('user_profile_public', {user_id:user.id,user_name:user.username|e('url')}) }}" class="username fg-{{ user.color }}">{{ user.username }}</a>
{% if user.donation > 0 %}<span class="fa fa-gift donator" title="Gracious Donator"></span>{% endif %}
 &middot; <small title="User Reputation">{{ user.reputation }}</small>
{% endmacro %}

{% macro username_colorless(user) %}
<a href="{{ path('user_profile_public', {user_id:user.id,user_name:user.username|e('url')}) }}" class="username">{{ user.username }}</a>
{% if user.donation > 0 %}<span class="fa fa-gift donator" title="Gracious Donator"></span>{% endif %}
 &middot; <small title="User Reputation">{{ user.reputation }}</small>
{% endmacro %}

{% macro decklist_social_icons(decklist) %}
<span class="social-icons">
	<a id="social-icon-like" href="#" class="social-icon-like" data-toggle="tooltip" data-placement="bottom" title="Like">
		<span class="fa fa-heart"></span> <span class="num">{{ decklist.nbVotes }}</span>
	</a>
	<a id="social-icon-favorite" href="#" class="social-icon-favorite" data-toggle="tooltip" data-placement="bottom" title="Favorite">
		<span class="fa fa-star"></span> <span class="num">{{ decklist.nbFavorites }}</span>
	</a>
	<a id="social-icon-comment" href="#comment-form" class="social-icon-comment" data-toggle="tooltip" data-placement="bottom" title="Comment">
		<span class="fa fa-comment"></span> <span class="num">{{ decklist.nbComments }}</span>
	</a>
	<span class="social-icon-version" data-toggle="tooltip" data-placement="bottom" title="Version">
		<span class="fa fa-code-fork"></span> <span class="num">{{ decklist.version }}</span>
	</a>
</span>
{% endmacro %}

{% macro slot_with_icons(slot) %}
{{ slot.quantity }}x <span class="icon icon-{{ slot.card.type.code }} fg-{{ slot.card.faction.code }}"></span> <a href="{{ path('cards_zoom', {card_code: slot.card.code }) }}" class="card card-tip" data-code="{{ slot.card.code }}">{{ slot.card.name }}</a>
{% endmacro %}

{% macro hero_highlight(hero, hero_meta, decklists) %}
	{% import _self as macros %}
	<div style="background-image: linear-gradient(100deg, {{hero_meta.colors[0]}} 49.5%, {{hero_meta.colors[2]}} 50%, {{hero_meta.colors[2]}} 51%, {{hero_meta.colors[1]}} 51.5%, {{hero_meta.colors[1]}} 100%); border-radius: 10px; padding: 0.5rem;">
		<header style="display: flex; align-items: center; gap: 1rem; justify-content: space-between; color: {{hero_meta.colors[3]}}; padding: 1rem;">
			<div>
				<h5 style="font-size: 16px; padding: 0;">Hero Spotlight</h5>
				<h4 style="font-size: 30px; display: flex; align-items: center; gap: 1rem; justify-content: space-between; margin: 0;">
					<div>
						<a style="color: {{hero_meta.colors[3]}};" href="/decklists/find?cards%5B%5D=01001a">{{hero.name}}</a>
					</div>
				</h4>
			</div>
			<div class="card-thumbnail-static card-thumbnail-wide card-thumbnail-investigator" style="background-image:url(/bundles/cards/{{hero.getCode()}}.jpg)"></div>
		</header>
		{% for decklist in decklists %}
			{{macros.decklist_block(decklist, true)}}
		{% endfor %}
	</div>
{% endmacro %}

{% macro decklist_block(data, compact) %}
	<div class="box" style="border-radius: 10px;">
		<div class="bg-faction {% if data.meta.aspect is defined %}faint-{{ data.meta.aspect }}{% endif %}" style="display: flex; align-items: center;">
			<h4 style="font-size: 1.15em; flex: 1; margin: 0; padding: 0.5rem;">
				<span class="icon icon-{{ data.faction.code }}"></span>
				<a href="{{ path('decklist_detail',{decklist_id:data.decklist.id,decklist_name:data.decklist.nameCanonical}) }}">{{ data.decklist.name }}</a>
			</h4>
			{% if not compact %}
			<div>
				<div class="card-thumbnail-wide card-thumbnail-investigator" style="background-image:url(/bundles/cards/{{data.decklist.getCharacter().getCode()}}.jpg)"></div>
			</div>
			{% endif %}
		</div>
		{% if compact %}
		<div style="background-color: white; padding: 0.5rem;">
		{% else %}
		<div style="padding: 0.5rem;">
		<!-- <div style="background-color: white; background-position: -200px -400px; background-size: 800px 1200px; background-image:url(/bundles/cards/{{data.decklist.getCharacter().getCode()}}.jpg);"> -->
		{% endif %}
			{% set character = data.decklist.getCharacter() %}
			<div style="display: flex; justify-content: stretch;">
				<div style="flex: 0.5;">
					<a class="card card-tip fg-{{ character.getFaction().getCode() }}" data-code="{{ character.getCode() }}" data-toggle="modal" data-target="#cardModal" data-remote="false" href="">{{data.decklist.getCharacter().getName()}}</a>
					<div>
					{% if data.meta.aspect is defined %}<span class="fa fa-circle fg-{{data.meta.aspect}}" title="{{data.meta.aspect}}"></span> {{data.meta.aspect|capitalize}} {% endif %}
					{% if data.meta.aspect2 is defined %}<span class="fa fa-circle fg-{{data.meta.aspect2}}" title="{{data.meta.aspect2}}"></span> {{data.meta.aspect2|capitalize}} {% endif %}
					</div>
					<div style="font-size: 1.2rem;">
						Tags: {{ data.decklist.tags | split(',') | join(', ')}}
					</div>
				</div>
				<div style="flex: 0.5; text-align: right;">
					<div class="small">
					{{ _self.decklist_social_icons(data.decklist ) }}
					</div>
					<div>
						<span class="username">by {{ _self.username_colorless(data.decklist.user) }}</span>
					</div>
					<div class="small pull-right">
						<time datetime="{{ data.decklist.dateCreation|date('c') }}">{{ data.decklist.dateCreation|date('M d, Y') }}</time>
					</div>
				</div>
			</div>
			<!--
			<div class="" style="padding: 2px 5px 5px 5px; background-color: rgba(255, 255, 255, 0.85);">
				{% if not compact %}
				<div class="pull-left" style="margin-right : 5px; margin-top : 2px;">
					<div class="card-thumbnail-static card-thumbnail-wide card-thumbnail-investigator" style="background-image:url(/bundles/cards/{{data.decklist.getCharacter().getCode()}}.jpg)"></div>
				</div>
				{% endif %}
				<div>
					<a class="card card-tip fg-{{ character.getFaction().getCode() }}" data-code="{{ character.getCode() }}" data-toggle="modal" data-target="#cardModal" data-remote="false" href="">{{data.decklist.getCharacter().getName()}}</a>
					<div class="small pull-right">
					{{ _self.decklist_social_icons(data.decklist ) }}
					</div>
				</div>
				<div>
				{% if data.meta.aspect is defined %}<span class="fa fa-circle fg-{{data.meta.aspect}}" title="{{data.meta.aspect}}"></span> {{data.meta.aspect|capitalize}} • {% endif %}
				{% if data.meta.aspect2 is defined %}<span class="fa fa-circle fg-{{data.meta.aspect2}}" title="{{data.meta.aspect2}}"></span> {{data.meta.aspect2|capitalize}} • {% endif %}
				Tags: {{ data.decklist.tags }}
				</div>
				<div>
					Author: <span class="username">{{ _self.username_colorless(data.decklist.user) }}</span>
					<div class="small pull-right">
					<time datetime="{{ data.decklist.dateCreation|date('c') }}">{{ data.decklist.dateCreation|date('M d, Y') }}</time>
					</div>
				</div>
			</div>
			-->
		</div>
	</div>
{% endmacro %}
